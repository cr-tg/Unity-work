# VR照片墙

[TOC]

## 项目介绍

​	这个项目是我们使用unity引擎针对HTC Vive设备开发的一款VR应用，简单来说就是一个VR版本的图片浏览器，大致效果就是让用户沉浸在图片的海洋之中， 可以使用Vive的控制器与图片交互、浏览图片的相关信息，也可以使用语音检索相关图片等等。我们还实现了碰撞避让算法，想象我们选择了一张远处的图片，我们希望这张图片很自然的从远处飞到近前方的位置，但是在整个图片的飞行路径上还有很多其它图片挡道， 我们不希望这张图片直接从其它图片中穿过去（视觉体验很差），而是希望挡道的图片很自然的让开一条道路，这就需要用到RVO碰撞避让算法。

## 主要工作

1. 应用逻辑实现

   - 使用Vive的控制器与图片进行交互（ 通过射线选择、移动图片、浏览图片信息等等）。

     这一部分没什么难点，主要是熟悉VRTK的API(这是一个主流的Unity VR应用的开发包)，通过VRTK提供的各种回调函数来完成各种交互功能。

   - 图片检索（检索相关图片，语音检索）

     语音检索使用了百度语音识别的API将语音转换为字符串，然后将字符串与事先加上去的图片标签做匹配，从而检索出目标图片。

2. RVO碰撞避让算法

   RVO要对Agent进行路径规划，实际上要完成的任务就是让Agent从点A无碰撞地移动到点B。

   基本思想是使用kd树来加速最近邻搜索, 根据邻近的agent的状态(位置速度等属性)来动态为当前agent进行路径规划。

3. 渲染与特效

   渲染基本使用了unity内置的渲染算法，不过我们自己也写shader实现了一些简单的特效，包括选中图片时图片边框的高亮效果，发光的射线效果，炫酷的3D背景效果(使用了Voronoi Noise, 也叫Celular Noise)。

4. 效率优化算法

   - LOD (根据距离动态调整图片的分辨率)、动态磁盘调度

     我们希望能同时显示成千上万张图片（图片的海洋），不可能同时把所有图片加载到内存。所以我们使用了LOD的思想，近处的图片使用较高的分辨率，远处的图片使用较低的分辨率。 对于远处的图片，不仅渲染时使用较低的分辨率，图片在内存中存放也要使用一个较低的分辨率，否则内存吃不消。 当图片由远到近时，我们需要将图片的分辨率动态的增大（这时需要从硬盘中重新读取高分辨率的图片，我们用一个协程来读取，这可以避免卡顿，但仍可能导致延迟）。

   - 图片动态平衡

     参考流体模拟的思想。
     
## 项目截图

​	很遗憾，这个项目没有截图。

1. 这个项目在实验室里面，而且逻辑很多，复现比较难。
2. 这个项目需要使用VIVE设备才看的出效果，我的破笔记本根本带不动。





